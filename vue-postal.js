function createObj(t){let e=function(){};return e.prototype=t,new e}function extend(t){let e,i,n=arguments.length;for(e=1;e<n;e++)for(i in arguments[e])t[i]=arguments[e][i];return t}function inherit(t,e){let i,n=arguments.length;for(t.prototype=createObj(e.prototype),t.prototype.constructor=t,i=2;i<n;i++)extend(t.prototype,arguments[i]);return t}const NOTHING=["<nothing>"],END="end",VALUE="value",ERROR="error",ANY="any";function concat(t,e){let i,n,r,s;if(0===t.length)return e;if(0===e.length)return t;for(s=0,i=new Array(t.length+e.length),n=t.length,r=0;r<n;r++,s++)i[s]=t[r];for(n=e.length,r=0;r<n;r++,s++)i[s]=e[r];return i}function find(t,e){let i,n=t.length;for(i=0;i<n;i++)if(t[i]===e)return i;return-1}function findByPred(t,e){let i,n=t.length;for(i=0;i<n;i++)if(e(t[i]))return i;return-1}function cloneArray(t){let e,i=t.length,n=new Array(i);for(e=0;e<i;e++)n[e]=t[e];return n}function remove(t,e){let i,n,r,s=t.length;if(e>=0&&e<s){if(1===s)return[];for(i=new Array(s-1),n=0,r=0;n<s;n++)n!==e&&(i[r]=t[n],r++);return i}return t}function map(t,e){let i,n=t.length,r=new Array(n);for(i=0;i<n;i++)r[i]=e(t[i]);return r}function forEach(t,e){let i,n=t.length;for(i=0;i<n;i++)e(t[i])}function fillArray(t,e){let i,n=t.length;for(i=0;i<n;i++)t[i]=e}function contains(t,e){return-1!==find(t,e)}function slide(t,e,i){let n,r=Math.min(i,t.length+1),s=t.length-r+1,a=new Array(r);for(n=s;n<r;n++)a[n-s]=t[n];return a[r-1]=e,a}function callSubscriber(t,e,i){t===ANY?e(i):t===i.type&&(t===VALUE||t===ERROR?e(i.value):e())}function Dispatcher(){this._items=[],this._spies=[],this._inLoop=0,this._removedItems=null}function Observable(){this._dispatcher=new Dispatcher,this._active=!1,this._alive=!0,this._activating=!1,this._logHandlers=null,this._spyHandlers=null}function Stream(){Observable.call(this)}function Property(){Observable.call(this),this._currentEvent=null}extend(Dispatcher.prototype,{add(t,e){return this._items=concat(this._items,[{type:t,fn:e}]),this._items.length},remove(t,e){const i=findByPred(this._items,i=>i.type===t&&i.fn===e);return 0!==this._inLoop&&-1!==i&&(null===this._removedItems&&(this._removedItems=[]),this._removedItems.push(this._items[i])),this._items=remove(this._items,i),this._items.length},addSpy(t){return this._spies=concat(this._spies,[t]),this._spies.length},removeSpy(t){return this._spies=remove(this._spies,this._spies.indexOf(t)),this._spies.length},dispatch(t){this._inLoop++;for(let e=0,i=this._spies;null!==this._spies&&e<i.length;e++)i[e](t);for(let e=0,i=this._items;e<i.length&&null!==this._items;e++)null!==this._removedItems&&contains(this._removedItems,i[e])||callSubscriber(i[e].type,i[e].fn,t);this._inLoop--,0===this._inLoop&&(this._removedItems=null)},cleanup(){this._items=null,this._spies=null}}),extend(Observable.prototype,{_name:"observable",_onActivation(){},_onDeactivation(){},_setActive(t){this._active!==t&&(this._active=t,t?(this._activating=!0,this._onActivation(),this._activating=!1):this._onDeactivation())},_clear(){this._setActive(!1),this._dispatcher.cleanup(),this._dispatcher=null,this._logHandlers=null},_emit(t,e){switch(t){case VALUE:return this._emitValue(e);case ERROR:return this._emitError(e);case END:return this._emitEnd()}},_emitValue(t){this._alive&&this._dispatcher.dispatch({type:VALUE,value:t})},_emitError(t){this._alive&&this._dispatcher.dispatch({type:ERROR,value:t})},_emitEnd(){this._alive&&(this._alive=!1,this._dispatcher.dispatch({type:END}),this._clear())},_on(t,e){return this._alive?(this._dispatcher.add(t,e),this._setActive(!0)):callSubscriber(t,e,{type:END}),this},_off(t,e){if(this._alive){0===this._dispatcher.remove(t,e)&&this._setActive(!1)}return this},onValue(t){return this._on(VALUE,t)},onError(t){return this._on(ERROR,t)},onEnd(t){return this._on(END,t)},onAny(t){return this._on(ANY,t)},offValue(t){return this._off(VALUE,t)},offError(t){return this._off(ERROR,t)},offEnd(t){return this._off(END,t)},offAny(t){return this._off(ANY,t)},observe(t,e,i){const n=this;let r=!1;const s=t&&"function"!=typeof t?t:{value:t,error:e,end:i},a=function(t){t.type===END&&(r=!0),t.type===VALUE&&s.value?s.value(t.value):t.type===ERROR&&s.error?s.error(t.value):t.type===END&&s.end&&s.end(t.value)};return this.onAny(a),{unsubscribe(){r||(n.offAny(a),r=!0)},get closed(){return r}}},_ofSameType(t,e){return t.prototype.getType()===this.getType()?t:e},setName(t,e){return this._name=e?`${t._name}.${e}`:t,this},log(t=this.toString()){let e,i=function(i){let n=`<${i.type}${e?":current":""}>`;i.type===END?console.log(t,n):console.log(t,n,i.value)};return this._alive&&(this._logHandlers||(this._logHandlers=[]),this._logHandlers.push({name:t,handler:i})),e=!0,this.onAny(i),e=!1,this},offLog(t=this.toString()){if(this._logHandlers){let e=findByPred(this._logHandlers,e=>e.name===t);-1!==e&&(this.offAny(this._logHandlers[e].handler),this._logHandlers.splice(e,1))}return this},spy(t=this.toString()){let e=function(e){let i=`<${e.type}>`;e.type===END?console.log(t,i):console.log(t,i,e.value)};return this._alive&&(this._spyHandlers||(this._spyHandlers=[]),this._spyHandlers.push({name:t,handler:e}),this._dispatcher.addSpy(e)),this},offSpy(t=this.toString()){if(this._spyHandlers){let e=findByPred(this._spyHandlers,e=>e.name===t);-1!==e&&(this._dispatcher.removeSpy(this._spyHandlers[e].handler),this._spyHandlers.splice(e,1))}return this}}),Observable.prototype.toString=function(){return`[${this._name}]`},inherit(Stream,Observable,{_name:"stream",getType:()=>"stream"}),inherit(Property,Observable,{_name:"property",_emitValue(t){this._alive&&(this._currentEvent={type:VALUE,value:t},this._activating||this._dispatcher.dispatch({type:VALUE,value:t}))},_emitError(t){this._alive&&(this._currentEvent={type:ERROR,value:t},this._activating||this._dispatcher.dispatch({type:ERROR,value:t}))},_emitEnd(){this._alive&&(this._alive=!1,this._activating||this._dispatcher.dispatch({type:END}),this._clear())},_on(t,e){return this._alive&&(this._dispatcher.add(t,e),this._setActive(!0)),null!==this._currentEvent&&callSubscriber(t,e,this._currentEvent),this._alive||callSubscriber(t,e,{type:END}),this},getType:()=>"property"});const neverS=new Stream;function never(){return neverS}function timeBased(t){function e(t,e){Stream.call(this),this._wait=t,this._intervalId=null,this._$onTick=(()=>this._onTick()),this._init(e)}return inherit(e,Stream,{_init(){},_free(){},_onTick(){},_onActivation(){this._intervalId=setInterval(this._$onTick,this._wait)},_onDeactivation(){null!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)},_clear(){Stream.prototype._clear.call(this),this._$onTick=null,this._free()}},t),e}neverS._emitEnd(),neverS._name="never";const S=timeBased({_name:"later",_init({x:t}){this._x=t},_free(){this._x=null},_onTick(){this._emitValue(this._x),this._emitEnd()}});function later(t,e){return new S(t,{x:e})}const S$1=timeBased({_name:"interval",_init({x:t}){this._x=t},_free(){this._x=null},_onTick(){this._emitValue(this._x)}});function interval(t,e){return new S$1(t,{x:e})}const S$2=timeBased({_name:"sequentially",_init({xs:t}){this._xs=cloneArray(t)},_free(){this._xs=null},_onTick(){1===this._xs.length?(this._emitValue(this._xs[0]),this._emitEnd()):this._emitValue(this._xs.shift())}});function sequentially(t,e){return 0===e.length?never():new S$2(t,{xs:e})}const S$3=timeBased({_name:"fromPoll",_init({fn:t}){this._fn=t},_free(){this._fn=null},_onTick(){const t=this._fn;this._emitValue(t())}});function fromPoll(t,e){return new S$3(t,{fn:e})}function emitter(t){function e(e){return t._emitValue(e),t._active}function i(e){return t._emit(e.type,e.value),t._active}return{value:e,error:function(e){return t._emitError(e),t._active},end:function(){return t._emitEnd(),t._active},event:i,emit:e,emitEvent:i}}const S$4=timeBased({_name:"withInterval",_init({fn:t}){this._fn=t,this._emitter=emitter(this)},_free(){this._fn=null,this._emitter=null},_onTick(){(0,this._fn)(this._emitter)}});function withInterval(t,e){return new S$4(t,{fn:e})}function S$5(t){Stream.call(this),this._fn=t,this._unsubscribe=null}function stream(t){return new S$5(t)}function fromCallback(t){let e=!1;return stream(function(i){e||(t(function(t){i.emit(t),i.end()}),e=!0)}).setName("fromCallback")}function fromNodeCallback(t){let e=!1;return stream(function(i){e||(t(function(t,e){t?i.error(t):i.emit(e),i.end()}),e=!0)}).setName("fromNodeCallback")}function spread(t,e){switch(e){case 0:return function(){return t()};case 1:return function(e){return t(e[0])};case 2:return function(e){return t(e[0],e[1])};case 3:return function(e){return t(e[0],e[1],e[2])};case 4:return function(e){return t(e[0],e[1],e[2],e[3])};default:return function(e){return t.apply(null,e)}}}function apply(t,e,i){let n=i?i.length:0;if(null==e)switch(n){case 0:return t();case 1:return t(i[0]);case 2:return t(i[0],i[1]);case 3:return t(i[0],i[1],i[2]);case 4:return t(i[0],i[1],i[2],i[3]);default:return t.apply(null,i)}else switch(n){case 0:return t.call(e);default:return t.apply(e,i)}}function fromSubUnsub(t,e,i){return stream(function(n){let r=i?function(){n.emit(apply(i,this,arguments))}:t=>{n.emit(t)};return t(r),()=>e(r)}).setName("fromSubUnsub")}inherit(S$5,Stream,{_name:"stream",_onActivation(){const t=(0,this._fn)(emitter(this));this._unsubscribe="function"==typeof t?t:null,this._active||this._callUnsubscribe()},_callUnsubscribe(){null!==this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null)},_onDeactivation(){this._callUnsubscribe()},_clear(){Stream.prototype._clear.call(this),this._fn=null}});const pairs=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"]];function fromEvents(t,e,i){let n,r;for(let e=0;e<pairs.length;e++)if("function"==typeof t[pairs[e][0]]&&"function"==typeof t[pairs[e][1]]){n=pairs[e][0],r=pairs[e][1];break}if(void 0===n)throw new Error("target don't support any of addEventListener/removeEventListener, addListener/removeListener, on/off method pair");return fromSubUnsub(i=>t[n](e,i),i=>t[r](e,i),i).setName("fromEvents")}function P(t){this._currentEvent={type:"value",value:t,current:!0}}function constant(t){return new P(t)}function P$1(t){this._currentEvent={type:"error",value:t,current:!0}}function constantError(t){return new P$1(t)}function createConstructor(t,e){return function(i,n){t.call(this),this._source=i,this._name=`${i._name}.${e}`,this._init(n),this._$handleAny=(t=>this._handleAny(t))}}function createClassMethods(t){return{_init(){},_free(){},_handleValue(t){this._emitValue(t)},_handleError(t){this._emitError(t)},_handleEnd(){this._emitEnd()},_handleAny(t){switch(t.type){case VALUE:return this._handleValue(t.value);case ERROR:return this._handleError(t.value);case END:return this._handleEnd()}},_onActivation(){this._source.onAny(this._$handleAny)},_onDeactivation(){this._source.offAny(this._$handleAny)},_clear(){t.prototype._clear.call(this),this._source=null,this._$handleAny=null,this._free()}}}function createStream(t,e){const i=createConstructor(Stream,t);return inherit(i,Stream,createClassMethods(Stream),e),i}function createProperty(t,e){const i=createConstructor(Property,t);return inherit(i,Property,createClassMethods(Property),e),i}inherit(P,Property,{_name:"constant",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null}),inherit(P$1,Property,{_name:"constantError",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null});const P$2=createProperty("toProperty",{_init({fn:t}){this._getInitialCurrent=t},_onActivation(){if(null!==this._getInitialCurrent){const t=this._getInitialCurrent;this._emitValue(t())}this._source.onAny(this._$handleAny)}});function toProperty(t,e=null){if(null!==e&&"function"!=typeof e)throw new Error("You should call toProperty() with a function or no arguments.");return new P$2(t,{fn:e})}const S$6=createStream("changes",{_handleValue(t){this._activating||this._emitValue(t)},_handleError(t){this._activating||this._emitError(t)}});function changes(t){return new S$6(t)}function fromPromise(t){let e=!1;return toProperty(stream(function(i){if(!e){let n=function(t){i.emit(t),i.end()},r=function(t){i.error(t),i.end()},s=t.then(n,r);s&&"function"==typeof s.done&&s.done(),e=!0}}),null).setName("fromPromise")}function getGlodalPromise(){if("function"==typeof Promise)return Promise;throw new Error("There isn't default Promise, use shim or parameter")}function toPromise(t,e=getGlodalPromise()){let i=null;return new e((e,n)=>{t.onAny(t=>{t.type===END&&null!==i?((i.type===VALUE?e:n)(i.value),i=null):i=t})})}function symbolObservablePonyfill(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}var root,result=symbolObservablePonyfill(root="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),$$observable=result.default?result.default:result;function fromESObservable(t){const e=t[$$observable]?t[$$observable]():t;return stream(function(t){const i=e.subscribe({error(e){t.error(e),t.end()},next(e){t.emit(e)},complete(){t.end()}});return i.unsubscribe?function(){i.unsubscribe()}:i}).setName("fromESObservable")}function ESObservable(t){this._observable=t.takeErrors(1)}function toESObservable(){return new ESObservable(this)}function collect(t,e,i){for(var n in t)t.hasOwnProperty(n)&&(e.push(n),i.push(t[n]))}function defaultErrorsCombinator(t){let e;for(let i=0;i<t.length;i++)void 0!==t[i]&&(void 0===e||e.index<t[i].index)&&(e=t[i]);return e.error}function Combine(t,e,i){Stream.call(this),this._activeCount=t.length,this._sources=concat(t,e),this._combinator=i,this._aliveCount=0,this._latestValues=new Array(this._sources.length),this._latestErrors=new Array(this._sources.length),fillArray(this._latestValues,NOTHING),this._emitAfterActivation=!1,this._endAfterActivation=!1,this._latestErrorIndex=0,this._$handlers=[];for(let t=0;t<this._sources.length;t++)this._$handlers.push(e=>this._handleAny(t,e))}function combineAsArray(t,e=[],i){if(!Array.isArray(e))throw new Error("Combine can only combine active and passive collections of the same type.");return i=i?spread(i,t.length+e.length):t=>t,0===t.length?never():new Combine(t,e,i)}function combineAsObject(t,e={},i){if("object"!=typeof e||Array.isArray(e))throw new Error("Combine can only combine active and passive collections of the same type.");let n=[],r=[],s=[];collect(t,n,r),collect(e,n,s);return 0===r.length?never():new Combine(r,s,t=>{let e={};for(let i=t.length-1;0<=i;i--)e[n[i]]=t[i];return i?i(e):e})}function combine(t,e,i){return"function"==typeof e&&(i=e,e=void 0),Array.isArray(t)?combineAsArray(t,e,i):combineAsObject(t,e,i)}extend(ESObservable.prototype,{subscribe(t,e,i){const n="function"==typeof t?{next:t,error:e,complete:i}:t,r=t=>{t.type===END&&(s=!0),t.type===VALUE&&n.next?n.next(t.value):t.type===ERROR&&n.error?n.error(t.value):t.type===END&&n.complete&&n.complete(t.value)};this._observable.onAny(r);let s=!1;return{unsubscribe:()=>{s=!0,this._observable.offAny(r)},get closed(){return s}}}}),ESObservable.prototype[$$observable]=function(){return this},inherit(Combine,Stream,{_name:"combine",_onActivation(){this._aliveCount=this._activeCount;for(let t=this._activeCount;t<this._sources.length;t++)this._sources[t].onAny(this._$handlers[t]);for(let t=0;t<this._activeCount;t++)this._sources[t].onAny(this._$handlers[t]);this._emitAfterActivation&&(this._emitAfterActivation=!1,this._emitIfFull()),this._endAfterActivation&&this._emitEnd()},_onDeactivation(){let t,e=this._sources.length;for(t=0;t<e;t++)this._sources[t].offAny(this._$handlers[t])},_emitIfFull(){let t=!0,e=!1,i=this._latestValues.length,n=new Array(i),r=new Array(i);for(let s=0;s<i;s++)n[s]=this._latestValues[s],r[s]=this._latestErrors[s],n[s]===NOTHING&&(t=!1),void 0!==r[s]&&(e=!0);if(t){const t=this._combinator;this._emitValue(t(n))}e&&this._emitError(defaultErrorsCombinator(r))},_handleAny(t,e){e.type===VALUE||e.type===ERROR?(e.type===VALUE&&(this._latestValues[t]=e.value,this._latestErrors[t]=void 0),e.type===ERROR&&(this._latestValues[t]=NOTHING,this._latestErrors[t]={index:this._latestErrorIndex++,error:e.value}),t<this._activeCount&&(this._activating?this._emitAfterActivation=!0:this._emitIfFull())):t<this._activeCount&&(this._aliveCount--,0===this._aliveCount&&(this._activating?this._endAfterActivation=!0:this._emitEnd()))},_clear(){Stream.prototype._clear.call(this),this._sources=null,this._latestValues=null,this._latestErrors=null,this._combinator=null,this._$handlers=null}});const Observable$2={empty:()=>never(),concat:(t,e)=>t.merge(e),of:t=>constant(t),map:(t,e)=>e.map(t),bimap:(t,e,i)=>i.mapErrors(t).map(e),ap:(t,e)=>combine([t,e],(t,e)=>t(e)),chain:(t,e)=>e.flatMap(t)};var staticLand=Object.freeze({Observable:Observable$2});const mixin={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleValue(t){const e=this._fn;this._emitValue(e(t))}},S$7=createStream("map",mixin),P$3=createProperty("map",mixin),id=t=>t;function map$1(t,e=id){return new(t._ofSameType(S$7,P$3))(t,{fn:e})}const mixin$1={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleValue(t){(0,this._fn)(t)&&this._emitValue(t)}},S$8=createStream("filter",mixin$1),P$4=createProperty("filter",mixin$1),id$1=t=>t;function filter(t,e=id$1){return new(t._ofSameType(S$8,P$4))(t,{fn:e})}const mixin$2={_init({n:t}){this._n=t,t<=0&&this._emitEnd()},_handleValue(t){0!==this._n&&(this._n--,this._emitValue(t),0===this._n&&this._emitEnd())}},S$9=createStream("take",mixin$2),P$5=createProperty("take",mixin$2);function take(t,e){return new(t._ofSameType(S$9,P$5))(t,{n:e})}const mixin$3={_init({n:t}){this._n=t,t<=0&&this._emitEnd()},_handleError(t){0!==this._n&&(this._n--,this._emitError(t),0===this._n&&this._emitEnd())}},S$10=createStream("takeErrors",mixin$3),P$6=createProperty("takeErrors",mixin$3);function takeErrors(t,e){return new(t._ofSameType(S$10,P$6))(t,{n:e})}const mixin$4={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleValue(t){(0,this._fn)(t)?this._emitValue(t):this._emitEnd()}},S$11=createStream("takeWhile",mixin$4),P$7=createProperty("takeWhile",mixin$4),id$2=t=>t;function takeWhile(t,e=id$2){return new(t._ofSameType(S$11,P$7))(t,{fn:e})}const mixin$5={_init(){this._lastValue=NOTHING},_free(){this._lastValue=null},_handleValue(t){this._lastValue=t},_handleEnd(){this._lastValue!==NOTHING&&this._emitValue(this._lastValue),this._emitEnd()}},S$12=createStream("last",mixin$5),P$8=createProperty("last",mixin$5);function last(t){return new(t._ofSameType(S$12,P$8))(t)}const mixin$6={_init({n:t}){this._n=Math.max(0,t)},_handleValue(t){0===this._n?this._emitValue(t):this._n--}},S$13=createStream("skip",mixin$6),P$9=createProperty("skip",mixin$6);function skip(t,e){return new(t._ofSameType(S$13,P$9))(t,{n:e})}const mixin$7={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleValue(t){const e=this._fn;null===this._fn||e(t)||(this._fn=null),null===this._fn&&this._emitValue(t)}},S$14=createStream("skipWhile",mixin$7),P$10=createProperty("skipWhile",mixin$7),id$3=t=>t;function skipWhile(t,e=id$3){return new(t._ofSameType(S$14,P$10))(t,{fn:e})}const mixin$8={_init({fn:t}){this._fn=t,this._prev=NOTHING},_free(){this._fn=null,this._prev=null},_handleValue(t){const e=this._fn;this._prev!==NOTHING&&e(this._prev,t)||(this._prev=t,this._emitValue(t))}},S$15=createStream("skipDuplicates",mixin$8),P$11=createProperty("skipDuplicates",mixin$8),eq=(t,e)=>t===e;function skipDuplicates(t,e=eq){return new(t._ofSameType(S$15,P$11))(t,{fn:e})}const mixin$9={_init({fn:t,seed:e}){this._fn=t,this._prev=e},_free(){this._prev=null,this._fn=null},_handleValue(t){if(this._prev!==NOTHING){const e=this._fn;this._emitValue(e(this._prev,t))}this._prev=t}},S$16=createStream("diff",mixin$9),P$12=createProperty("diff",mixin$9);function defaultFn(t,e){return[t,e]}function diff(t,e,i=NOTHING){return new(t._ofSameType(S$16,P$12))(t,{fn:e||defaultFn,seed:i})}const P$13=createProperty("scan",{_init({fn:t,seed:e}){this._fn=t,this._seed=e,e!==NOTHING&&this._emitValue(e)},_free(){this._fn=null,this._seed=null},_handleValue(t){const e=this._fn;null===this._currentEvent||this._currentEvent.type===ERROR?this._emitValue(this._seed===NOTHING?t:e(this._seed,t)):this._emitValue(e(this._currentEvent.value,t))}});function scan(t,e,i=NOTHING){return new P$13(t,{fn:e,seed:i})}const mixin$10={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleValue(t){const e=(0,this._fn)(t);for(let t=0;t<e.length;t++)this._emitValue(e[t])}},S$17=createStream("flatten",mixin$10),id$4=t=>t;function flatten(t,e=id$4){return new S$17(t,{fn:e})}const END_MARKER={},mixin$11={_init({wait:t}){this._wait=Math.max(0,t),this._buff=[],this._$shiftBuff=(()=>{const t=this._buff.shift();t===END_MARKER?this._emitEnd():this._emitValue(t)})},_free(){this._buff=null,this._$shiftBuff=null},_handleValue(t){this._activating?this._emitValue(t):(this._buff.push(t),setTimeout(this._$shiftBuff,this._wait))},_handleEnd(){this._activating?this._emitEnd():(this._buff.push(END_MARKER),setTimeout(this._$shiftBuff,this._wait))}},S$18=createStream("delay",mixin$11),P$14=createProperty("delay",mixin$11);function delay(t,e){return new(t._ofSameType(S$18,P$14))(t,{wait:e})}var now=Date.now?()=>Date.now():()=>(new Date).getTime();const mixin$12={_init({wait:t,leading:e,trailing:i}){this._wait=Math.max(0,t),this._leading=e,this._trailing=i,this._trailingValue=null,this._timeoutId=null,this._endLater=!1,this._lastCallTime=0,this._$trailingCall=(()=>this._trailingCall())},_free(){this._trailingValue=null,this._$trailingCall=null},_handleValue(t){if(this._activating)this._emitValue(t);else{let e=now();0!==this._lastCallTime||this._leading||(this._lastCallTime=e);let i=this._wait-(e-this._lastCallTime);i<=0?(this._cancelTrailing(),this._lastCallTime=e,this._emitValue(t)):this._trailing&&(this._cancelTrailing(),this._trailingValue=t,this._timeoutId=setTimeout(this._$trailingCall,i))}},_handleEnd(){this._activating?this._emitEnd():this._timeoutId?this._endLater=!0:this._emitEnd()},_cancelTrailing(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},_trailingCall(){this._emitValue(this._trailingValue),this._timeoutId=null,this._trailingValue=null,this._lastCallTime=this._leading?now():0,this._endLater&&this._emitEnd()}},S$19=createStream("throttle",mixin$12),P$15=createProperty("throttle",mixin$12);function throttle(t,e,{leading:i=!0,trailing:n=!0}={}){return new(t._ofSameType(S$19,P$15))(t,{wait:e,leading:i,trailing:n})}const mixin$13={_init({wait:t,immediate:e}){this._wait=Math.max(0,t),this._immediate=e,this._lastAttempt=0,this._timeoutId=null,this._laterValue=null,this._endLater=!1,this._$later=(()=>this._later())},_free(){this._laterValue=null,this._$later=null},_handleValue(t){this._activating?this._emitValue(t):(this._lastAttempt=now(),this._immediate&&!this._timeoutId&&this._emitValue(t),this._timeoutId||(this._timeoutId=setTimeout(this._$later,this._wait)),this._immediate||(this._laterValue=t))},_handleEnd(){this._activating?this._emitEnd():this._timeoutId&&!this._immediate?this._endLater=!0:this._emitEnd()},_later(){let t=now()-this._lastAttempt;t<this._wait&&t>=0?this._timeoutId=setTimeout(this._$later,this._wait-t):(this._timeoutId=null,this._immediate||(this._emitValue(this._laterValue),this._laterValue=null),this._endLater&&this._emitEnd())}},S$20=createStream("debounce",mixin$13),P$16=createProperty("debounce",mixin$13);function debounce(t,e,{immediate:i=!1}={}){return new(t._ofSameType(S$20,P$16))(t,{wait:e,immediate:i})}const mixin$14={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleError(t){const e=this._fn;this._emitError(e(t))}},S$21=createStream("mapErrors",mixin$14),P$17=createProperty("mapErrors",mixin$14),id$5=t=>t;function mapErrors(t,e=id$5){return new(t._ofSameType(S$21,P$17))(t,{fn:e})}const mixin$15={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleError(t){(0,this._fn)(t)&&this._emitError(t)}},S$22=createStream("filterErrors",mixin$15),P$18=createProperty("filterErrors",mixin$15),id$6=t=>t;function filterErrors(t,e=id$6){return new(t._ofSameType(S$22,P$18))(t,{fn:e})}const mixin$16={_handleValue(){}},S$23=createStream("ignoreValues",mixin$16),P$19=createProperty("ignoreValues",mixin$16);function ignoreValues(t){return new(t._ofSameType(S$23,P$19))(t)}const mixin$17={_handleError(){}},S$24=createStream("ignoreErrors",mixin$17),P$20=createProperty("ignoreErrors",mixin$17);function ignoreErrors(t){return new(t._ofSameType(S$24,P$20))(t)}const mixin$18={_handleEnd(){}},S$25=createStream("ignoreEnd",mixin$18),P$21=createProperty("ignoreEnd",mixin$18);function ignoreEnd(t){return new(t._ofSameType(S$25,P$21))(t)}const mixin$19={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleEnd(){const t=this._fn;this._emitValue(t()),this._emitEnd()}},S$26=createStream("beforeEnd",mixin$19),P$22=createProperty("beforeEnd",mixin$19);function beforeEnd(t,e){return new(t._ofSameType(S$26,P$22))(t,{fn:e})}const mixin$20={_init({min:t,max:e}){this._max=e,this._min=t,this._buff=[]},_free(){this._buff=null},_handleValue(t){this._buff=slide(this._buff,t,this._max),this._buff.length>=this._min&&this._emitValue(this._buff)}},S$27=createStream("slidingWindow",mixin$20),P$23=createProperty("slidingWindow",mixin$20);function slidingWindow(t,e,i=0){return new(t._ofSameType(S$27,P$23))(t,{min:i,max:e})}const mixin$21={_init({fn:t,flushOnEnd:e}){this._fn=t,this._flushOnEnd=e,this._buff=[]},_free(){this._buff=null},_flush(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue(t){this._buff.push(t),(0,this._fn)(t)||this._flush()},_handleEnd(){this._flushOnEnd&&this._flush(),this._emitEnd()}},S$28=createStream("bufferWhile",mixin$21),P$24=createProperty("bufferWhile",mixin$21),id$7=t=>t;function bufferWhile(t,e,{flushOnEnd:i=!0}={}){return new(t._ofSameType(S$28,P$24))(t,{fn:e||id$7,flushOnEnd:i})}const mixin$22={_init({count:t,flushOnEnd:e}){this._count=t,this._flushOnEnd=e,this._buff=[]},_free(){this._buff=null},_flush(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue(t){this._buff.push(t),this._buff.length>=this._count&&this._flush()},_handleEnd(){this._flushOnEnd&&this._flush(),this._emitEnd()}},S$29=createStream("bufferWithCount",mixin$22),P$25=createProperty("bufferWithCount",mixin$22);function bufferWhile$1(t,e,{flushOnEnd:i=!0}={}){return new(t._ofSameType(S$29,P$25))(t,{count:e,flushOnEnd:i})}const mixin$23={_init({wait:t,count:e,flushOnEnd:i}){this._wait=t,this._count=e,this._flushOnEnd=i,this._intervalId=null,this._$onTick=(()=>this._flush()),this._buff=[]},_free(){this._$onTick=null,this._buff=null},_flush(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handleValue(t){this._buff.push(t),this._buff.length>=this._count&&(clearInterval(this._intervalId),this._flush(),this._intervalId=setInterval(this._$onTick,this._wait))},_handleEnd(){this._flushOnEnd&&0!==this._buff.length&&this._flush(),this._emitEnd()},_onActivation(){this._intervalId=setInterval(this._$onTick,this._wait),this._source.onAny(this._$handleAny)},_onDeactivation(){null!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this._source.offAny(this._$handleAny)}},S$30=createStream("bufferWithTimeOrCount",mixin$23),P$26=createProperty("bufferWithTimeOrCount",mixin$23);function bufferWithTimeOrCount(t,e,i,{flushOnEnd:n=!0}={}){return new(t._ofSameType(S$30,P$26))(t,{wait:e,count:i,flushOnEnd:n})}function xformForObs(t){return{"@@transducer/step":(e,i)=>(t._emitValue(i),null),"@@transducer/result":()=>(t._emitEnd(),null)}}const mixin$24={_init({transducer:t}){this._xform=t(xformForObs(this))},_free(){this._xform=null},_handleValue(t){null!==this._xform["@@transducer/step"](null,t)&&this._xform["@@transducer/result"](null)},_handleEnd(){this._xform["@@transducer/result"](null)}},S$31=createStream("transduce",mixin$24),P$27=createProperty("transduce",mixin$24);function transduce(t,e){return new(t._ofSameType(S$31,P$27))(t,{transducer:e})}const mixin$25={_init({fn:t}){this._handler=t,this._emitter=emitter(this)},_free(){this._handler=null,this._emitter=null},_handleAny(t){this._handler(this._emitter,t)}},S$32=createStream("withHandler",mixin$25),P$28=createProperty("withHandler",mixin$25);function withHandler(t,e){return new(t._ofSameType(S$32,P$28))(t,{fn:e})}const isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function Zip(t,e){Stream.call(this),this._buffers=map(t,t=>isArray(t)?cloneArray(t):[]),this._sources=map(t,t=>isArray(t)?never():t),this._combinator=e?spread(e,this._sources.length):t=>t,this._aliveCount=0,this._$handlers=[];for(let t=0;t<this._sources.length;t++)this._$handlers.push(e=>this._handleAny(t,e))}function zip(t,e){return 0===t.length?never():new Zip(t,e)}inherit(Zip,Stream,{_name:"zip",_onActivation(){for(;this._isFull();)this._emit();const t=this._sources.length;this._aliveCount=t;for(let e=0;e<t&&this._active;e++)this._sources[e].onAny(this._$handlers[e])},_onDeactivation(){for(let t=0;t<this._sources.length;t++)this._sources[t].offAny(this._$handlers[t])},_emit(){let t=new Array(this._buffers.length);for(let e=0;e<this._buffers.length;e++)t[e]=this._buffers[e].shift();const e=this._combinator;this._emitValue(e(t))},_isFull(){for(let t=0;t<this._buffers.length;t++)if(0===this._buffers[t].length)return!1;return!0},_handleAny(t,e){e.type===VALUE&&(this._buffers[t].push(e.value),this._isFull()&&this._emit()),e.type===ERROR&&this._emitError(e.value),e.type===END&&(this._aliveCount--,0===this._aliveCount&&this._emitEnd())},_clear(){Stream.prototype._clear.call(this),this._sources=null,this._buffers=null,this._combinator=null,this._$handlers=null}});const id$8=t=>t;function AbstractPool({queueLim:t=0,concurLim:e=-1,drop:i="new"}={}){Stream.call(this),this._queueLim=t<0?-1:t,this._concurLim=e<0?-1:e,this._drop=i,this._queue=[],this._curSources=[],this._$handleSubAny=(t=>this._handleSubAny(t)),this._$endHandlers=[],this._currentlyAdding=null,0===this._concurLim&&this._emitEnd()}function Merge(t){AbstractPool.call(this),this._addAll(t),this._initialised=!0}function merge(t){return 0===t.length?never():new Merge(t)}function S$33(t){Stream.call(this),this._generator=t,this._source=null,this._inLoop=!1,this._iteration=0,this._$handleAny=(t=>this._handleAny(t))}function repeat(t){return new S$33(t)}function concat$1(t){return repeat(function(e){return t.length>e&&t[e]}).setName("concat")}function Pool(){AbstractPool.call(this)}function FlatMap(t,e,i){AbstractPool.call(this,i),this._source=t,this._fn=e,this._mainEnded=!1,this._lastCurrent=null,this._$handleMain=(t=>this._handleMain(t))}function FlatMapErrors(t,e){FlatMap.call(this,t,e)}function createConstructor$1(t,e){return function(i,n,r){t.call(this),this._primary=i,this._secondary=n,this._name=`${i._name}.${e}`,this._lastSecondary=NOTHING,this._$handleSecondaryAny=(t=>this._handleSecondaryAny(t)),this._$handlePrimaryAny=(t=>this._handlePrimaryAny(t)),this._init(r)}}function createClassMethods$1(t){return{_init(){},_free(){},_handlePrimaryValue(t){this._emitValue(t)},_handlePrimaryError(t){this._emitError(t)},_handlePrimaryEnd(){this._emitEnd()},_handleSecondaryValue(t){this._lastSecondary=t},_handleSecondaryError(t){this._emitError(t)},_handleSecondaryEnd(){},_handlePrimaryAny(t){switch(t.type){case VALUE:return this._handlePrimaryValue(t.value);case ERROR:return this._handlePrimaryError(t.value);case END:return this._handlePrimaryEnd(t.value)}},_handleSecondaryAny(t){switch(t.type){case VALUE:return this._handleSecondaryValue(t.value);case ERROR:return this._handleSecondaryError(t.value);case END:this._handleSecondaryEnd(t.value),this._removeSecondary()}},_removeSecondary(){null!==this._secondary&&(this._secondary.offAny(this._$handleSecondaryAny),this._$handleSecondaryAny=null,this._secondary=null)},_onActivation(){null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny),this._active&&this._primary.onAny(this._$handlePrimaryAny)},_onDeactivation(){null!==this._secondary&&this._secondary.offAny(this._$handleSecondaryAny),this._primary.offAny(this._$handlePrimaryAny)},_clear(){t.prototype._clear.call(this),this._primary=null,this._secondary=null,this._lastSecondary=null,this._$handleSecondaryAny=null,this._$handlePrimaryAny=null,this._free()}}}function createStream$1(t,e){const i=createConstructor$1(Stream,t);return inherit(i,Stream,createClassMethods$1(Stream),e),i}function createProperty$1(t,e){const i=createConstructor$1(Property,t);return inherit(i,Property,createClassMethods$1(Property),e),i}inherit(AbstractPool,Stream,{_name:"abstractPool",_add(t,e){e=e||id$8,-1===this._concurLim||this._curSources.length<this._concurLim?this._addToCur(e(t)):-1===this._queueLim||this._queue.length<this._queueLim?this._addToQueue(e(t)):"old"===this._drop&&(this._removeOldest(),this._add(t,e))},_addAll(t){forEach(t,t=>this._add(t))},_remove(t){-1===this._removeCur(t)&&this._removeQueue(t)},_addToQueue(t){this._queue=concat(this._queue,[t])},_addToCur(t){if(this._active){if(!t._alive)return void(t._currentEvent&&this._emit(t._currentEvent.type,t._currentEvent.value));this._currentlyAdding=t,t.onAny(this._$handleSubAny),this._currentlyAdding=null,t._alive&&(this._curSources=concat(this._curSources,[t]),this._active&&this._subToEnd(t))}else this._curSources=concat(this._curSources,[t])},_subToEnd(t){const e=()=>this._removeCur(t);this._$endHandlers.push({obs:t,handler:e}),t.onEnd(e)},_subscribe(t){t.onAny(this._$handleSubAny),this._active&&this._subToEnd(t)},_unsubscribe(t){t.offAny(this._$handleSubAny);let e=findByPred(this._$endHandlers,e=>e.obs===t);-1!==e&&(t.offEnd(this._$endHandlers[e].handler),this._$endHandlers.splice(e,1))},_handleSubAny(t){t.type===VALUE?this._emitValue(t.value):t.type===ERROR&&this._emitError(t.value)},_removeQueue(t){let e=find(this._queue,t);return this._queue=remove(this._queue,e),e},_removeCur(t){this._active&&this._unsubscribe(t);let e=find(this._curSources,t);return this._curSources=remove(this._curSources,e),-1!==e&&(0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()),e},_removeOldest(){this._removeCur(this._curSources[0])},_pullQueue(){0!==this._queue.length&&(this._queue=cloneArray(this._queue),this._addToCur(this._queue.shift()))},_onActivation(){for(let t=0,e=this._curSources;t<e.length&&this._active;t++)this._subscribe(e[t])},_onDeactivation(){for(let t=0,e=this._curSources;t<e.length;t++)this._unsubscribe(e[t]);null!==this._currentlyAdding&&this._unsubscribe(this._currentlyAdding)},_isEmpty(){return 0===this._curSources.length},_onEmpty(){},_clear(){Stream.prototype._clear.call(this),this._queue=null,this._curSources=null,this._$handleSubAny=null,this._$endHandlers=null}}),inherit(Merge,AbstractPool,{_name:"merge",_onEmpty(){this._initialised&&this._emitEnd()}}),inherit(S$33,Stream,{_name:"repeat",_handleAny(t){t.type===END?(this._source=null,this._getSource()):this._emit(t.type,t.value)},_getSource(){if(!this._inLoop){this._inLoop=!0;const t=this._generator;for(;null===this._source&&this._alive&&this._active;)this._source=t(this._iteration++),this._source?this._source.onAny(this._$handleAny):this._emitEnd();this._inLoop=!1}},_onActivation(){this._source?this._source.onAny(this._$handleAny):this._getSource()},_onDeactivation(){this._source&&this._source.offAny(this._$handleAny)},_clear(){Stream.prototype._clear.call(this),this._generator=null,this._source=null,this._$handleAny=null}}),inherit(Pool,AbstractPool,{_name:"pool",plug(t){return this._add(t),this},unplug(t){return this._remove(t),this}}),inherit(FlatMap,AbstractPool,{_onActivation(){AbstractPool.prototype._onActivation.call(this),this._active&&this._source.onAny(this._$handleMain)},_onDeactivation(){AbstractPool.prototype._onDeactivation.call(this),this._source.offAny(this._$handleMain),this._hadNoEvSinceDeact=!0},_handleMain(t){if(t.type===VALUE){this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1}t.type===ERROR&&this._emitError(t.value),t.type===END&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)},_onEmpty(){this._mainEnded&&this._emitEnd()},_clear(){AbstractPool.prototype._clear.call(this),this._source=null,this._lastCurrent=null,this._$handleMain=null}}),inherit(FlatMapErrors,FlatMap,{_handleMain(t){if(t.type===ERROR){this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1}t.type===VALUE&&this._emitValue(t.value),t.type===END&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)}});const mixin$26={_handlePrimaryValue(t){this._lastSecondary!==NOTHING&&this._lastSecondary&&this._emitValue(t)},_handleSecondaryEnd(){this._lastSecondary!==NOTHING&&this._lastSecondary||this._emitEnd()}},S$34=createStream$1("filterBy",mixin$26),P$29=createProperty$1("filterBy",mixin$26);function filterBy(t,e){return new(t._ofSameType(S$34,P$29))(t,e)}const id2=(t,e)=>e;function sampledBy(t,e,i){return combine([e],[t],i?(t,e)=>i(e,t):id2).setName(t,"sampledBy")}const mixin$27={_handlePrimaryValue(t){this._lastSecondary!==NOTHING&&this._emitValue(t)},_handleSecondaryEnd(){this._lastSecondary===NOTHING&&this._emitEnd()}},S$35=createStream$1("skipUntilBy",mixin$27),P$30=createProperty$1("skipUntilBy",mixin$27);function skipUntilBy(t,e){return new(t._ofSameType(S$35,P$30))(t,e)}const mixin$28={_handleSecondaryValue(){this._emitEnd()}},S$36=createStream$1("takeUntilBy",mixin$28),P$31=createProperty$1("takeUntilBy",mixin$28);function takeUntilBy(t,e){return new(t._ofSameType(S$36,P$31))(t,e)}const mixin$29={_init({flushOnEnd:t=!0}={}){this._buff=[],this._flushOnEnd=t},_free(){this._buff=null},_flush(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd(){this._flushOnEnd&&this._flush(),this._emitEnd()},_onActivation(){this._primary.onAny(this._$handlePrimaryAny),this._alive&&null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny)},_handlePrimaryValue(t){this._buff.push(t)},_handleSecondaryValue(){this._flush()},_handleSecondaryEnd(){this._flushOnEnd||this._emitEnd()}},S$37=createStream$1("bufferBy",mixin$29),P$32=createProperty$1("bufferBy",mixin$29);function bufferBy(t,e,i){return new(t._ofSameType(S$37,P$32))(t,e,i)}const mixin$30={_init({flushOnEnd:t=!0,flushOnChange:e=!1}={}){this._buff=[],this._flushOnEnd=t,this._flushOnChange=e},_free(){this._buff=null},_flush(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd(){this._flushOnEnd&&this._flush(),this._emitEnd()},_handlePrimaryValue(t){this._buff.push(t),this._lastSecondary===NOTHING||this._lastSecondary||this._flush()},_handleSecondaryEnd(){this._flushOnEnd||this._lastSecondary!==NOTHING&&!this._lastSecondary||this._emitEnd()},_handleSecondaryValue(t){this._flushOnChange&&!t&&this._flush(),this._lastSecondary=t}},S$38=createStream$1("bufferWhileBy",mixin$30),P$33=createProperty$1("bufferWhileBy",mixin$30);function bufferWhileBy(t,e,i){return new(t._ofSameType(S$38,P$33))(t,e,i)}const f=()=>!1,t=()=>!0;function awaiting(e,i){let n=merge([map$1(e,t),map$1(i,f)]);return(n=toProperty(n=skipDuplicates(n),f)).setName(e,"awaiting")}const mixin$31={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleValue(t){let e=(0,this._fn)(t);e.convert?this._emitError(e.error):this._emitValue(t)}},S$39=createStream("valuesToErrors",mixin$31),P$34=createProperty("valuesToErrors",mixin$31),defFn=t=>({convert:!0,error:t});function valuesToErrors(t,e=defFn){return new(t._ofSameType(S$39,P$34))(t,{fn:e})}const mixin$32={_init({fn:t}){this._fn=t},_free(){this._fn=null},_handleError(t){const e=(0,this._fn)(t);e.convert?this._emitValue(e.value):this._emitError(t)}},S$40=createStream("errorsToValues",mixin$32),P$35=createProperty("errorsToValues",mixin$32),defFn$1=t=>({convert:!0,value:t});function errorsToValues(t,e=defFn$1){return new(t._ofSameType(S$40,P$35))(t,{fn:e})}const mixin$33={_handleError(t){this._emitError(t),this._emitEnd()}},S$41=createStream("endOnError",mixin$33),P$36=createProperty("endOnError",mixin$33);function endOnError(t){return new(t._ofSameType(S$41,P$36))(t)}Observable.prototype.toProperty=function(t){return toProperty(this,t)},Observable.prototype.changes=function(){return changes(this)},Observable.prototype.toPromise=function(t){return toPromise(this,t)},Observable.prototype.toESObservable=toESObservable,Observable.prototype[$$observable]=toESObservable,Observable.prototype.map=function(t){return map$1(this,t)},Observable.prototype.filter=function(t){return filter(this,t)},Observable.prototype.take=function(t){return take(this,t)},Observable.prototype.takeErrors=function(t){return takeErrors(this,t)},Observable.prototype.takeWhile=function(t){return takeWhile(this,t)},Observable.prototype.last=function(){return last(this)},Observable.prototype.skip=function(t){return skip(this,t)},Observable.prototype.skipWhile=function(t){return skipWhile(this,t)},Observable.prototype.skipDuplicates=function(t){return skipDuplicates(this,t)},Observable.prototype.diff=function(t,e){return diff(this,t,e)},Observable.prototype.scan=function(t,e){return scan(this,t,e)},Observable.prototype.flatten=function(t){return flatten(this,t)},Observable.prototype.delay=function(t){return delay(this,t)},Observable.prototype.throttle=function(t,e){return throttle(this,t,e)},Observable.prototype.debounce=function(t,e){return debounce(this,t,e)},Observable.prototype.mapErrors=function(t){return mapErrors(this,t)},Observable.prototype.filterErrors=function(t){return filterErrors(this,t)},Observable.prototype.ignoreValues=function(){return ignoreValues(this)},Observable.prototype.ignoreErrors=function(){return ignoreErrors(this)},Observable.prototype.ignoreEnd=function(){return ignoreEnd(this)},Observable.prototype.beforeEnd=function(t){return beforeEnd(this,t)},Observable.prototype.slidingWindow=function(t,e){return slidingWindow(this,t,e)},Observable.prototype.bufferWhile=function(t,e){return bufferWhile(this,t,e)},Observable.prototype.bufferWithCount=function(t,e){return bufferWhile$1(this,t,e)},Observable.prototype.bufferWithTimeOrCount=function(t,e,i){return bufferWithTimeOrCount(this,t,e,i)},Observable.prototype.transduce=function(t){return transduce(this,t)},Observable.prototype.withHandler=function(t){return withHandler(this,t)},Observable.prototype.thru=function(t){return t(this)},Observable.prototype.combine=function(t,e){return combine([this,t],e)},Observable.prototype.zip=function(t,e){return zip([this,t],e)},Observable.prototype.merge=function(t){return merge([this,t])},Observable.prototype.concat=function(t){return concat$1([this,t])};const pool=function(){return new Pool};Observable.prototype.flatMap=function(t){return new FlatMap(this,t).setName(this,"flatMap")},Observable.prototype.flatMapLatest=function(t){return new FlatMap(this,t,{concurLim:1,drop:"old"}).setName(this,"flatMapLatest")},Observable.prototype.flatMapFirst=function(t){return new FlatMap(this,t,{concurLim:1}).setName(this,"flatMapFirst")},Observable.prototype.flatMapConcat=function(t){return new FlatMap(this,t,{queueLim:-1,concurLim:1}).setName(this,"flatMapConcat")},Observable.prototype.flatMapConcurLimit=function(t,e){return new FlatMap(this,t,{queueLim:-1,concurLim:e}).setName(this,"flatMapConcurLimit")},Observable.prototype.flatMapErrors=function(t){return new FlatMapErrors(this,t).setName(this,"flatMapErrors")},Observable.prototype.filterBy=function(t){return filterBy(this,t)},Observable.prototype.sampledBy=function(t,e){return sampledBy(this,t,e)},Observable.prototype.skipUntilBy=function(t){return skipUntilBy(this,t)},Observable.prototype.takeUntilBy=function(t){return takeUntilBy(this,t)},Observable.prototype.bufferBy=function(t,e){return bufferBy(this,t,e)},Observable.prototype.bufferWhileBy=function(t,e){return bufferWhileBy(this,t,e)};let DEPRECATION_WARNINGS=!0;function warn(t){if(DEPRECATION_WARNINGS&&console&&"function"==typeof console.warn){const e="\nHere is an Error object for you containing the call stack:";console.warn(t,e,new Error)}}Observable.prototype.awaiting=function(t){return warn("You are using deprecated .awaiting() method, see https://github.com/kefirjs/kefir/issues/145"),awaiting(this,t)},Observable.prototype.valuesToErrors=function(t){return warn("You are using deprecated .valuesToErrors() method, see https://github.com/kefirjs/kefir/issues/149"),valuesToErrors(this,t)},Observable.prototype.errorsToValues=function(t){return warn("You are using deprecated .errorsToValues() method, see https://github.com/kefirjs/kefir/issues/149"),errorsToValues(this,t)},Observable.prototype.endOnError=function(){return warn("You are using deprecated .endOnError() method, see https://github.com/kefirjs/kefir/issues/150"),endOnError(this)};const Kefir={Observable:Observable,Stream:Stream,Property:Property,never:never,later:later,interval:interval,sequentially:sequentially,fromPoll:fromPoll,withInterval:withInterval,fromCallback:fromCallback,fromNodeCallback:fromNodeCallback,fromEvents:fromEvents,stream:stream,constant:constant,constantError:constantError,fromPromise:fromPromise,fromESObservable:fromESObservable,combine:combine,zip:zip,merge:merge,concat:concat$1,Pool:Pool,pool:pool,repeat:repeat,staticLand:staticLand};function eventBus(){let t,e,i,n=function(t,e,i){this.stream=t,this.onUnsubscribe=null,this.subscription=t.observe({value:function(t){e(t.data,t)},error:i}),r(t)};function r(t){t.subscriberCount=t.subscriberCount?t.subscriberCount+1:1}function s(t){t.subscriberCount||--t.subscriberCount||delete i[t._source._channelName].topics[t._binding]}function a(t){if(-1===t.indexOf("#")&&-1===t.indexOf("*"))return function(e){return e.topic===t};{let e=function(t){let e,i="^"+t.split(".").map(function(t){let i="";return e&&(i="#"!==e?"\\.\\b":"\\b"),e=t,i+="#"===t?"[\\s\\S]*":"*"===t?"[^.]+":t}).join("")+"$";return new RegExp(i)}(t);return function(t){return e.test(t.topic)}}}function o(e,n){let r=(i[s=e]||(i[s]={stream:t.filter(function(t){return t.channel===s}),topics:{}},i[s].stream._channelName=s),i[s]);var s;let o=a(n),l=r.topics[n]||(r.topics[n]=r.stream.filter(function(t){return o(t)}));return l._binding=n,l}function l(){i={},e&&e.end(),e=null,t=Kefir.stream(function(t){return e=t,function(){e=null}})}return n.prototype.unsubscribe=function(){"function"==typeof this.onUnsubscribe&&this.onUnsubscribe(),this.subscription.unsubscribe(),s(this.stream)},l(),{publish:function(t){t.timestamp=(new Date).toISOString(),e&&e.emit(t)},subscribe:function(t){return new n(o(t.channel,t.topic),t.callback)},wiretap:function(e){let i=t.observe({value:function(t){e(t.data,t)}});return function(){i.unsubscribe()}},reset:l,when:function(t,e,i,n){let a=[],l=n||{};t.forEach(function(t){let e=o(t.channel,t.topic);r(e),a.push(e)});let h=Kefir.zip(a),u=(l.once?h.take(1):h).map(function(t){return t.map(function(t){return t.data})}).observe({value:function(t){e.apply(this,t)},error:i,end:_});function _(){u.unsubscribe(),a.forEach(function(t){s(t)}),a=[]}return _}}}Kefir.Kefir=Kefir;let event=eventBus();function vuePostal(t){vuePostal.installed||(event.reset(),Object.defineProperty(t.prototype,"$event",{get:function(){let t=this;return{subscribe:function(){let e=event.subscribe.apply(event,arguments);return e.onUnsubscribe=t.$on("hook:beforeDestroy",function(){e.unsubscribe()}),e},publish:event.publish.bind(event),wiretap:event.wiretap.bind(event),when:event.when.bind(event),reset:event.reset}}}))}"undefined"!=typeof window&&window.Vue&&window.Vue.use(vuePostal);export default vuePostal;
